{"version":3,"sources":["../src/match.ts"],"names":["matchPositions","trade","positions","legs","_","chain","map","position","overlapping","reduce","acc","leg","found_leg","find","p_leg","symbol","score","length","filter","x","orderBy","value"],"mappings":";;;;;;;AAAA;;;;;;AAaO,SAASA,cAAT,CAAiDC,KAAjD,EAAwEC,SAAxE,EAA0H;AAE/H,MAAIC,IAAI,GAAGF,KAAK,CAACE,IAAjB;AAEA,SAAOC,CAAC,CAACC,KAAF,CAAQH,SAAR,EACJI,GADI,CACCC,QAAD,IAAc;AACjB,QAAIC,WAAW,GAAGJ,CAAC,CAACK,MAAF,CAASN,IAAT,EAAe,CAACO,GAAD,EAAMC,GAAN,KAAc;AAC7C,UAAIC,SAAS,GAAGR,CAAC,CAACS,IAAF,CAAON,QAAQ,CAACJ,IAAhB,EAAuBW,KAAD,IAAWA,KAAK,CAACC,MAAN,KAAiBJ,GAAG,CAACI,MAAtD,CAAhB;;AACA,UAAGH,SAAH,EAAc;AACZF,QAAAA,GAAG,IAAI,CAAP;AACD;;AACD,aAAOA,GAAP;AACD,KANiB,EAMf,CANe,CAAlB;;AAQA,WAAO;AACLM,MAAAA,KAAK,EAAER,WAAW,GAAGD,QAAQ,CAACJ,IAAT,CAAcc,MAD9B;AAELT,MAAAA,WAFK;AAGLD,MAAAA;AAHK,KAAP;AAKD,GAfI,EAgBJW,MAhBI,CAgBIC,CAAD,IAAOA,CAAC,CAACH,KAAF,GAAU,CAhBpB,EAiBJI,OAjBI,CAiBKD,CAAD,IAAOA,CAAC,CAACH,KAjBb,EAiBqB,MAjBrB,EAkBJK,KAlBI,EAAP;AAmBD","sourcesContent":["import * as _ from 'lodash';\nimport { OptionLeg } from './types';\n\nexport interface HasOptionLegs {\n  legs : OptionLeg[];\n}\n\nexport interface MatchingPositionScore<T> {\n  score: number;\n  overlapping : number;\n  position: T;\n}\n\nexport function matchPositions<T extends HasOptionLegs>(trade : HasOptionLegs, positions: T[]) : Array<MatchingPositionScore<T>> {\n\n  let legs = trade.legs;\n\n  return _.chain(positions)\n    .map((position) => {\n      let overlapping = _.reduce(legs, (acc, leg) => {\n        let found_leg = _.find(position.legs, (p_leg) => p_leg.symbol === leg.symbol);\n        if(found_leg) {\n          acc += 1;\n        }\n        return acc;\n      }, 0);\n\n      return {\n        score: overlapping / position.legs.length,\n        overlapping,\n        position,\n      };\n    })\n    .filter((x) => x.score > 0)\n    .orderBy((x) => x.score,  'desc')\n    .value();\n}\n"],"file":"match.js"}